<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="In this notebook we are gonna be looking at the following steps in a pipeline preprocessing, feature extraction, feature selection, model fitting"><meta name=author content="Juma Shafara"><link href=https://easi.ac.ug/python-for-data-science/Machine%20Learning/82_sklearn_pipeline/ rel=canonical><link href=../81_regression_metrics/ rel=prev><link href=../83_GridSearchCV/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.9"><title>Pipeline - Python for Data Science</title><link rel=stylesheet href=../../assets/stylesheets/main.4af4bdda.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><!-- Add Material Icons --><link rel=stylesheet href="https://fonts.googleapis.com/icon?family=Material+Icons"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=DM+Sans:300,300i,400,400i,700,700i%7CDM+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"DM Sans";--md-code-font:"DM Mono"}</style><link rel=stylesheet href=../../styles/custom.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=custom data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#pipeline class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <button class="md-banner__button md-icon" aria-label="Don't show this again"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> <!-- Add announcement here, including arbitrary HTML --> <div class=announce> <p>Welcome to our new Data Science resource site!</p> </div> </div> <script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script> </aside> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=https://www.easi.ac.ug/ title="Python for Data Science" class="md-header__button md-logo" aria-label="Python for Data Science" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Python for Data Science </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Pipeline </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=custom data-md-color-accent=indigo aria-label="Dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=custom data-md-color-accent=indigo aria-label="Light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../Python/11_python_tutorial/ class=md-tabs__link> Python </a> </li> <li class=md-tabs__item> <a href=../../Python/Libraries/12_numpy/ class=md-tabs__link> Data Collection and Visualization </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../41_overview_of_machine_learning/ class=md-tabs__link> Machine Learning </a> </li> <li class=md-tabs__item> <a href=../../Deep%20Learning/outline/ class=md-tabs__link> Deep Learning </a> </li> <li class=md-tabs__item> <a href=../../Time%20Series/90_introduction/ class=md-tabs__link> Time Series </a> </li> <li class=md-tabs__item> <a href=../../Maths%20%26%20Statistics/50_maths_and_stats_for_ds/ class=md-tabs__link> Maths & Statistics </a> </li> <li class=md-tabs__item> <a href=../../Extras/customer_analysis/ class=md-tabs__link> Extras </a> </li> <li class=md-tabs__item> <a href=../../LICENSE class=md-tabs__link> About </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=https://www.easi.ac.ug/ title="Python for Data Science" class="md-nav__button md-logo" aria-label="Python for Data Science" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> Python for Data Science </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Python </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Python </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Python/11_python_tutorial/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../Python/13_end_of_course_exercise/ class=md-nav__link> <span class=md-ellipsis> End of Course Exercise </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3 id=__nav_2_3_label tabindex=0> <span class=md-ellipsis> Basics </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Basics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Python/Basics/00_python_programming_outline/ class=md-nav__link> <span class=md-ellipsis> Outline </span> </a> </li> <li class=md-nav__item> <a href=../../Python/Basics/01_basics/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../Python/Basics/02_variables/ class=md-nav__link> <span class=md-ellipsis> Variables </span> </a> </li> <li class=md-nav__item> <a href=../../Python/Basics/03_numbers/ class=md-nav__link> <span class=md-ellipsis> Numbers </span> </a> </li> <li class=md-nav__item> <a href=../../Python/Basics/03_strings/ class=md-nav__link> <span class=md-ellipsis> Strings </span> </a> </li> <li class=md-nav__item> <a href=../../Python/Basics/04_operators/ class=md-nav__link> <span class=md-ellipsis> Operators </span> </a> </li> <li class=md-nav__item> <a href=../../Python/Basics/05_containers/ class=md-nav__link> <span class=md-ellipsis> Containers </span> </a> </li> <li class=md-nav__item> <a href=../../Python/Basics/06_flow_control/ class=md-nav__link> <span class=md-ellipsis> Flow Control </span> </a> </li> <li class=md-nav__item> <a href=../../Python/Basics/07_advanced/ class=md-nav__link> <span class=md-ellipsis> Advanced </span> </a> </li> <li class=md-nav__item> <a href=../../Python/Basics/08_modules/ class=md-nav__link> <span class=md-ellipsis> Modules </span> </a> </li> <li class=md-nav__item> <a href=../../Python/Basics/09_file_handling/ class=md-nav__link> <span class=md-ellipsis> File Handling </span> </a> </li> <li class=md-nav__item> <a href=../../Python/Basics/13_end_of_course_exercise/ class=md-nav__link> <span class=md-ellipsis> End of Course Exercise </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4 id=__nav_2_4_label tabindex=0> <span class=md-ellipsis> Built-in </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> Built-in </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Python/Python%20Builtin/filter_function/ class=md-nav__link> <span class=md-ellipsis> Filter Function </span> </a> </li> <li class=md-nav__item> <a href=../../Python/Python%20Builtin/map_function/ class=md-nav__link> <span class=md-ellipsis> Map Function </span> </a> </li> <li class=md-nav__item> <a href=../../Python/Python%20Builtin/reduce_function/ class=md-nav__link> <span class=md-ellipsis> Reduce Function </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_5> <label class=md-nav__link for=__nav_2_5 id=__nav_2_5_label tabindex=0> <span class=md-ellipsis> Libraries </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_5_label aria-expanded=false> <label class=md-nav__title for=__nav_2_5> <span class="md-nav__icon md-icon"></span> Libraries </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Python/Libraries/12_numpy/ class=md-nav__link> <span class=md-ellipsis> NumPy Crash Course </span> </a> </li> <li class=md-nav__item> <a href=../../Python/Libraries/13_pandas/ class=md-nav__link> <span class=md-ellipsis> Pandas Crash Course </span> </a> </li> <li class=md-nav__item> <a href=../../Data%20Collection%20and%20Visulization/31_matplotlib_refined/ class=md-nav__link> <span class=md-ellipsis> Matplotlib Crash Course </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Data Collection and Visualization </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Data Collection and Visualization </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Python/Libraries/12_numpy/ class=md-nav__link> <span class=md-ellipsis> NumPy Crash Course </span> </a> </li> <li class=md-nav__item> <a href=../../Python/Libraries/13_pandas/ class=md-nav__link> <span class=md-ellipsis> Pandas Crash Course </span> </a> </li> <li class=md-nav__item> <a href=../../Data%20Collection%20and%20Visulization/21_weather_data/ class=md-nav__link> <span class=md-ellipsis> Weather Data </span> </a> </li> <li class=md-nav__item> <a href=../../Data%20Collection%20and%20Visulization/31_matplotlib_refined/ class=md-nav__link> <span class=md-ellipsis> Matplotlib Crash Course </span> </a> </li> <li class=md-nav__item> <a href=../../Data%20Collection%20and%20Visulization/32_data_exploration_and_cleaning_exercise/ class=md-nav__link> <span class=md-ellipsis> Data Exploration Exercise </span> </a> </li> <li class=md-nav__item> <a href=../../Data%20Collection%20and%20Visulization/76_handling_missing_data/ class=md-nav__link> <span class=md-ellipsis> Handling Missing Data </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4 checked> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex> <span class=md-ellipsis> Machine Learning </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=true> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Machine Learning </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../41_overview_of_machine_learning/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../42_training_models_meaning/ class=md-nav__link> <span class=md-ellipsis> Training Models </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_3> <label class=md-nav__link for=__nav_4_3 id=__nav_4_3_label tabindex=0> <span class=md-ellipsis> Unsupervised Learning </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_3_label aria-expanded=false> <label class=md-nav__title for=__nav_4_3> <span class="md-nav__icon md-icon"></span> Unsupervised Learning </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../43_sklearn-unsupervised-learning/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../43_sklearn-unsupervised-learning2/ class=md-nav__link> <span class=md-ellipsis> Advanced </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_4> <label class=md-nav__link for=__nav_4_4 id=__nav_4_4_label tabindex=0> <span class=md-ellipsis> Feature Engineering </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4_4> <span class="md-nav__icon md-icon"></span> Feature Engineering </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../71_feature_selection/ class=md-nav__link> <span class=md-ellipsis> Feature Selection </span> </a> </li> <li class=md-nav__item> <a href=../72_why_scaling/ class=md-nav__link> <span class=md-ellipsis> Why Scaling </span> </a> </li> <li class=md-nav__item> <a href=../72_why_scaling_fpl/ class=md-nav__link> <span class=md-ellipsis> Feature Scaling (FPL) </span> </a> </li> <li class=md-nav__item> <a href=../73_normalization_and_standardization/ class=md-nav__link> <span class=md-ellipsis> Normalization and Standardization </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../76_handling_missing_data/ class=md-nav__link> <span class=md-ellipsis> Handling Missing Data </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_6> <label class=md-nav__link for=__nav_4_6 id=__nav_4_6_label tabindex=0> <span class=md-ellipsis> Model Evaluation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_6_label aria-expanded=false> <label class=md-nav__title for=__nav_4_6> <span class="md-nav__icon md-icon"></span> Model Evaluation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../80_classification_metrics/ class=md-nav__link> <span class=md-ellipsis> Classification Metrics </span> </a> </li> <li class=md-nav__item> <a href=../81_regression_metrics/ class=md-nav__link> <span class=md-ellipsis> Regression Metrics </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_7 checked> <label class=md-nav__link for=__nav_4_7 id=__nav_4_7_label tabindex=0> <span class=md-ellipsis> Advanced Techniques </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_7_label aria-expanded=true> <label class=md-nav__title for=__nav_4_7> <span class="md-nav__icon md-icon"></span> Advanced Techniques </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Pipelines </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Pipelines </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#pipeline class=md-nav__link> <span class=md-ellipsis> Pipeline </span> </a> <nav class=md-nav aria-label=Pipeline> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lets-redefine-a-model class=md-nav__link> <span class=md-ellipsis> Let's redefine a model </span> </a> </li> <li class=md-nav__item> <a href=#training-our-first-model class=md-nav__link> <span class=md-ellipsis> Training our first model </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#some-feature-selection class=md-nav__link> <span class=md-ellipsis> Some feature selection. </span> </a> <nav class=md-nav aria-label="Some feature selection."> <ul class=md-nav__list> <li class=md-nav__item> <a href=#training-our-second-model class=md-nav__link> <span class=md-ellipsis> Training our second model </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#transforming-the-data class=md-nav__link> <span class=md-ellipsis> Transforming the data </span> </a> <nav class=md-nav aria-label="Transforming the data"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#training-our-third-model class=md-nav__link> <span class=md-ellipsis> Training our third model </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#the-pipeline class=md-nav__link> <span class=md-ellipsis> The Pipeline </span> </a> <nav class=md-nav aria-label="The Pipeline"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#combine-preprocessing-steps class=md-nav__link> <span class=md-ellipsis> Combine Preprocessing Steps </span> </a> </li> <li class=md-nav__item> <a href=#pipeline_1 class=md-nav__link> <span class=md-ellipsis> Pipeline </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../83_GridSearchCV/ class=md-nav__link> <span class=md-ellipsis> Hyperparameter Tuning </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Deep Learning </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Deep Learning </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Deep%20Learning/outline/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_2> <label class=md-nav__link for=__nav_5_2 id=__nav_5_2_label tabindex=0> <span class=md-ellipsis> Tensors & Datasets </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_2_label aria-expanded=false> <label class=md-nav__title for=__nav_5_2> <span class="md-nav__icon md-icon"></span> Tensors & Datasets </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Deep%20Learning/Week1-Tensors-Datasets/1.1_1Dtensors_v2/ class=md-nav__link> <span class=md-ellipsis> 1D Tensors </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week1-Tensors-Datasets/1.1_2%20Two-Dimensional%20Tensors_v2/ class=md-nav__link> <span class=md-ellipsis> 2D Tensors </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week1-Tensors-Datasets/1.2derivativesandGraphsinPytorch_v2/ class=md-nav__link> <span class=md-ellipsis> Derivatives & Graphs </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week1-Tensors-Datasets/1.3.1_simple_data_set_v2/ class=md-nav__link> <span class=md-ellipsis> Simple Datasets </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week1-Tensors-Datasets/1.3.3_pre-Built%20Datasets_and_transforms_v2/ class=md-nav__link> <span class=md-ellipsis> Pre-Built Datasets </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week1-Tensors-Datasets/tensors_and_datasets_exercise/ class=md-nav__link> <span class=md-ellipsis> Exercise </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_3> <label class=md-nav__link for=__nav_5_3 id=__nav_5_3_label tabindex=0> <span class=md-ellipsis> Linear Regression </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_3_label aria-expanded=false> <label class=md-nav__title for=__nav_5_3> <span class="md-nav__icon md-icon"></span> Linear Regression </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Deep%20Learning/Week2-Linear-Regression/2.1Prediction1Dregression_v3/ class=md-nav__link> <span class=md-ellipsis> 1D Regression </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week2-Linear-Regression/2.2_linear_regression_one_parameter_v3/ class=md-nav__link> <span class=md-ellipsis> One Parameter </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week2-Linear-Regression/2.3_training_slope_and_bias_v3/ class=md-nav__link> <span class=md-ellipsis> Slope & Bias </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week2-Linear-Regression/linear_regression_exercise/ class=md-nav__link> <span class=md-ellipsis> Exercise </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_4> <label class=md-nav__link for=__nav_5_4 id=__nav_5_4_label tabindex=0> <span class=md-ellipsis> LR in PyTorch </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_4_label aria-expanded=false> <label class=md-nav__title for=__nav_5_4> <span class="md-nav__icon md-icon"></span> LR in PyTorch </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Deep%20Learning/Week3-LR-PyTorch/3.1_stochastic_gradient_descent_v3/ class=md-nav__link> <span class=md-ellipsis> SGD </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week3-LR-PyTorch/3.2_mini-batch_gradient_descent_v3/ class=md-nav__link> <span class=md-ellipsis> Mini-Batch GD </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week3-LR-PyTorch/3.3_PyTorchway_v3/ class=md-nav__link> <span class=md-ellipsis> PyTorch Way </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week3-LR-PyTorch/3.6_training_and_validation_v3/ class=md-nav__link> <span class=md-ellipsis> Training & Validation </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week3-LR-PyTorch/linear_regression_in_pytorch_exercise/ class=md-nav__link> <span class=md-ellipsis> Exercise </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_5> <label class=md-nav__link for=__nav_5_5 id=__nav_5_5_label tabindex=0> <span class=md-ellipsis> Multiple Input LR </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5_5> <span class="md-nav__icon md-icon"></span> Multiple Input LR </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Deep%20Learning/Week4-Multiple-Input-LR/4.1.multiple_linear_regression_prediction_v2/ class=md-nav__link> <span class=md-ellipsis> Multiple LR Prediction </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week4-Multiple-Input-LR/4.2.multiple_linear_regression_training_v2/ class=md-nav__link> <span class=md-ellipsis> Multiple LR Training </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week4-Multiple-Input-LR/4.3.multi-target_linear_regression/ class=md-nav__link> <span class=md-ellipsis> Multi-Target LR </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week4-Multiple-Input-LR/4.4.training_multiple_output_linear_regression/ class=md-nav__link> <span class=md-ellipsis> Training Multiple Output </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week4-Multiple-Input-LR/muliple_input_lr_exercise/ class=md-nav__link> <span class=md-ellipsis> Exercise </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_6> <label class=md-nav__link for=__nav_5_6 id=__nav_5_6_label tabindex=0> <span class=md-ellipsis> Logistic Regression </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_6_label aria-expanded=false> <label class=md-nav__title for=__nav_5_6> <span class="md-nav__icon md-icon"></span> Logistic Regression </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Deep%20Learning/Week5-Logistic-Regression/5.1logistic_regression_prediction_v2/ class=md-nav__link> <span class=md-ellipsis> Prediction </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week5-Logistic-Regression/5.2.2bad_inshilization_logistic_regression_with_mean_square_error_v2/ class=md-nav__link> <span class=md-ellipsis> MSE Issues </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week5-Logistic-Regression/5.3_cross_entropy_logistic_regression_v2/ class=md-nav__link> <span class=md-ellipsis> Cross Entropy </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week5-Logistic-Regression/5.4softmax_in_one_dimension_v2/ class=md-nav__link> <span class=md-ellipsis> Softmax </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week5-Logistic-Regression/logistic_regression_exercise/ class=md-nav__link> <span class=md-ellipsis> Exercise </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_7> <label class=md-nav__link for=__nav_5_7 id=__nav_5_7_label tabindex=0> <span class=md-ellipsis> Practice </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_7_label aria-expanded=false> <label class=md-nav__title for=__nav_5_7> <span class="md-nav__icon md-icon"></span> Practice </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Deep%20Learning/Week6-Practice/6.1_custom_datasets/ class=md-nav__link> <span class=md-ellipsis> Custom Datasets </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week6-Practice/6.2_dataloaders/ class=md-nav__link> <span class=md-ellipsis> DataLoaders </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week6-Practice/6.3_transforms/ class=md-nav__link> <span class=md-ellipsis> Transforms </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_8> <label class=md-nav__link for=__nav_5_8 id=__nav_5_8_label tabindex=0> <span class=md-ellipsis> Shallow Networks </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_8_label aria-expanded=false> <label class=md-nav__title for=__nav_5_8> <span class="md-nav__icon md-icon"></span> Shallow Networks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Deep%20Learning/Week7-Shallow-Networks/7.1_simple1hiddenlayer/ class=md-nav__link> <span class=md-ellipsis> Simple Hidden Layer </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week7-Shallow-Networks/7.2multiple_neurons/ class=md-nav__link> <span class=md-ellipsis> this is for exercises </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week7-Shallow-Networks/7.3xor_v2/ class=md-nav__link> <span class=md-ellipsis> XOR Problem </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week7-Shallow-Networks/7.4one_layer_neural_network_MNIST/ class=md-nav__link> <span class=md-ellipsis> MNIST </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week7-Shallow-Networks/7.5.1activationfuction_v2/ class=md-nav__link> <span class=md-ellipsis> Activation Functions </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week7-Shallow-Networks/7.5.2mist1layer_v2/ class=md-nav__link> <span class=md-ellipsis> MNIST One Layer </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_9> <label class=md-nav__link for=__nav_5_9 id=__nav_5_9_label tabindex=0> <span class=md-ellipsis> Deep Networks </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_9_label aria-expanded=false> <label class=md-nav__title for=__nav_5_9> <span class="md-nav__icon md-icon"></span> Deep Networks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Deep%20Learning/Week8-Deep-Networks/8.1.1mist2layer_v2/ class=md-nav__link> <span class=md-ellipsis> MNIST Two Layer </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week8-Deep-Networks/8.1.2mulitclassspiralrulu_v2/ class=md-nav__link> <span class=md-ellipsis> Multiclass Spiral </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week8-Deep-Networks/8.2.1dropoutPredictin_v2/ class=md-nav__link> <span class=md-ellipsis> Dropout Prediction </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week8-Deep-Networks/8.2.2dropoutRegression_v2/ class=md-nav__link> <span class=md-ellipsis> Dropout Regression </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week8-Deep-Networks/8.3.1.initializationsame/ class=md-nav__link> <span class=md-ellipsis> Initialization </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week8-Deep-Networks/8.3.2Xaviermist1layer_v2/ class=md-nav__link> <span class=md-ellipsis> Xavier Init </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week8-Deep-Networks/8.3.3.He_Initialization_v2/ class=md-nav__link> <span class=md-ellipsis> He Init </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week8-Deep-Networks/8.4.1_MomentumwithPolynomialFunctions_v2/ class=md-nav__link> <span class=md-ellipsis> Momentum </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week8-Deep-Networks/8.4.2_NeuralNetworkswithMomentum_v2/ class=md-nav__link> <span class=md-ellipsis> NN with Momentum </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week8-Deep-Networks/8.5.1BachNorm_v2/ class=md-nav__link> <span class=md-ellipsis> Batch Normalization </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_10> <label class=md-nav__link for=__nav_5_10 id=__nav_5_10_label tabindex=0> <span class=md-ellipsis> CNNs </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_10_label aria-expanded=false> <label class=md-nav__title for=__nav_5_10> <span class="md-nav__icon md-icon"></span> CNNs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Deep%20Learning/Week9-CNNs/9.1What_is_Convolution/ class=md-nav__link> <span class=md-ellipsis> Convolution Basics </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week9-CNNs/9.2Activation_max_pooling/ class=md-nav__link> <span class=md-ellipsis> Activation & Pooling </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week9-CNNs/9.3Multiple_Channel_Convolution/ class=md-nav__link> <span class=md-ellipsis> Multiple Channels </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week9-CNNs/9.4.1ConvolutionalNeralNetworkSimple%20example/ class=md-nav__link> <span class=md-ellipsis> Simple CNN </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week9-CNNs/9.4.2CNN_Small_Image/ class=md-nav__link> <span class=md-ellipsis> CNN Small Image </span> </a> </li> <li class=md-nav__item> <a href=../../Deep%20Learning/Week9-CNNs/9.4.3CNN_Small_Image_batch/ class=md-nav__link> <span class=md-ellipsis> CNN Batch Processing </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Time Series </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Time Series </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Time%20Series/90_introduction/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../Time%20Series/91_analysis/ class=md-nav__link> <span class=md-ellipsis> Analysis </span> </a> </li> <li class=md-nav__item> <a href=../../Time%20Series/92_forecasting/ class=md-nav__link> <span class=md-ellipsis> Forecasting </span> </a> </li> <li class=md-nav__item> <a href=../../Time%20Series/93_python_example/ class=md-nav__link> <span class=md-ellipsis> Python Example </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> Maths & Statistics </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Maths & Statistics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Maths%20%26%20Statistics/50_maths_and_stats_for_ds/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../Maths%20%26%20Statistics/1_eigen_values_vectors/ class=md-nav__link> <span class=md-ellipsis> Eigen Values and Vectors </span> </a> </li> <li class=md-nav__item> <a href=../../Maths%20%26%20Statistics/51_descriptive_statistics/ class=md-nav__link> <span class=md-ellipsis> Descriptive Statistics </span> </a> </li> <li class=md-nav__item> <a href=../../Maths%20%26%20Statistics/52_inferencial_statistics/ class=md-nav__link> <span class=md-ellipsis> Inferential Statistics </span> </a> </li> <li class=md-nav__item> <a href=../../Maths%20%26%20Statistics/53_implementing_statistical_models/ class=md-nav__link> <span class=md-ellipsis> Statistical Models </span> </a> </li> <li class=md-nav__item> <a href=../../Maths%20%26%20Statistics/hypothesis_testing/ class=md-nav__link> <span class=md-ellipsis> Hypothesis Testing </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex=0> <span class=md-ellipsis> Extras </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Extras </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Extras/customer_analysis/ class=md-nav__link> <span class=md-ellipsis> Customer Analysis </span> </a> </li> <li class=md-nav__item> <a href=../../Extras/how_KNN_works/ class=md-nav__link> <span class=md-ellipsis> How KNN Works </span> </a> </li> <li class=md-nav__item> <a href=../../Extras/handling_imbalanced_data/ class=md-nav__link> <span class=md-ellipsis> Handling Imbalanced Data </span> </a> </li> <li class=md-nav__item> <a href=../../Extras/classification_metrics/ class=md-nav__link> <span class=md-ellipsis> Classification Metrics </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_9> <label class=md-nav__link for=__nav_9 id=__nav_9_label tabindex=0> <span class=md-ellipsis> About </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_9_label aria-expanded=false> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> About </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../LICENSE class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> <li class=md-nav__item> <a href=../../README.md class=md-nav__link> <span class=md-ellipsis> ReadMe </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#pipeline class=md-nav__link> <span class=md-ellipsis> Pipeline </span> </a> <nav class=md-nav aria-label=Pipeline> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lets-redefine-a-model class=md-nav__link> <span class=md-ellipsis> Let's redefine a model </span> </a> </li> <li class=md-nav__item> <a href=#training-our-first-model class=md-nav__link> <span class=md-ellipsis> Training our first model </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#some-feature-selection class=md-nav__link> <span class=md-ellipsis> Some feature selection. </span> </a> <nav class=md-nav aria-label="Some feature selection."> <ul class=md-nav__list> <li class=md-nav__item> <a href=#training-our-second-model class=md-nav__link> <span class=md-ellipsis> Training our second model </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#transforming-the-data class=md-nav__link> <span class=md-ellipsis> Transforming the data </span> </a> <nav class=md-nav aria-label="Transforming the data"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#training-our-third-model class=md-nav__link> <span class=md-ellipsis> Training our third model </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#the-pipeline class=md-nav__link> <span class=md-ellipsis> The Pipeline </span> </a> <nav class=md-nav aria-label="The Pipeline"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#combine-preprocessing-steps class=md-nav__link> <span class=md-ellipsis> Combine Preprocessing Steps </span> </a> </li> <li class=md-nav__item> <a href=#pipeline_1 class=md-nav__link> <span class=md-ellipsis> Pipeline </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>Pipelines</h1> <p><img alt="Photo by DATAIDEA" src=../../assets/banner4.png></p> <h2 id=pipeline>Pipeline</h2> <p>A pipeline is a series of data processing steps that are chained together sequentially. Each step in the pipeline typically performs some transformation on the data. In this notebook we are gonna be looking at the following steps in a pipeline: </p> <ul> <li>Preprocessing</li> <li>Feature extraction</li> <li>Feature selection</li> <li>Model fitting</li> </ul> <!-- Newsletter --> <div class=newsletter> <div class=newsletter-heading> <h4><i class="bi bi-info-circle-fill"></i> Don't Miss Any Updates!</h4> </div> <div class=newsletter-body> <p> Before we continue, we have a humble request, to be among the first to hear about future updates of the course materials, simply enter your email below, follow us on <a href=https://x.com/dataideaorg><i class="bi bi-twitter-x"></i> (formally Twitter)</a>, or subscribe to our <a href=https://www.youtube.com/@dataidea-science><i class="bi bi-youtube"></i> YouTube channel</a>. </p> <iframe class=newsletter-frame src="https://embeds.beehiiv.com/5fc7c425-9c7e-4e08-a514-ad6c22beee74?slim=true" data-test-id=beehiiv-embed height=52 frameborder=0 scrolling=no> </iframe> </div> </div> <h3 id=lets-redefine-a-model>Let's redefine a model</h3> <p>In week 4, we introduced ourselves to Machine Learning Concepts, in week 5 we learned some statistical tests and we applied them in week 7 to find the best feature and transform them to efficient forms. In this section, we will build on top of those concepts to redefine what a Machine Learning model is and hence come up with a more efficient way of developing <em>good</em> Machine Learning models</p> <p>First, let's install the <code>dataidea</code> package, which will help us with loading packages and datasets with much more ease</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=c1>## install the version of dataidea used for this notebook</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=c1># !pip install --upgrade dataidea</span>
</span></code></pre></div> <div class="language-python highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=c1># Let&#39;s import some packages</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=kn>import</span><span class=w> </span><span class=nn>dataidea</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>di</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.neighbors</span><span class=w> </span><span class=kn>import</span> <span class=n>KNeighborsRegressor</span>
</span></code></pre></div> <div class="language-python highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=c1># loading the data set</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=n>data</span> <span class=o>=</span> <span class=n>di</span><span class=o>.</span><span class=n>loadDataset</span><span class=p>(</span><span class=s1>&#39;boston&#39;</span><span class=p>)</span>
</span></code></pre></div> <p>The Boston Housing Dataset</p> <p>The Boston Housing Dataset is a derived from information collected by the U.S. Census Service concerning housing in the area of <a href=http://www.cs.toronto.edu/~delve/data/boston/bostonDetail.html> Boston MA</a>. The following describes the dataset columns:</p> <ul> <li>CRIM - per capita crime rate by town</li> <li>ZN - proportion of residential land zoned for lots over 25,000 sq.ft.</li> <li>INDUS - proportion of non-retail business acres per town.</li> <li>CHAS - Charles River dummy variable (1 if tract bounds river; 0 otherwise)</li> <li>NOX - nitric oxides concentration (parts per 10 million)</li> <li>RM - average number of rooms per dwelling</li> <li>AGE - proportion of owner-occupied units built prior to 1940</li> <li>DIS - weighted distances to five Boston employment centres</li> <li>RAD - index of accessibility to radial highways</li> <li>TAX - full-value property-tax rate per $10,000</li> <li>PTRATIO - pupil-teacher ratio by town</li> <li>B - 1000(Bk - 0.63)^2 where Bk is the proportion of blacks by town</li> <li>LSTAT - % lower status of the population</li> <li>MEDV - Median value of owner-occupied homes in $1000's</li> </ul> <div class="language-python highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=c1># looking at the top part</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=n>data</span><span class=o>.</span><span class=n>head</span><span class=p>()</span>
</span></code></pre></div> <div> <style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style> <table border=1 class=dataframe> <thead> <tr style="text-align: right;"> <th></th> <th>CRIM</th> <th>ZN</th> <th>INDUS</th> <th>CHAS</th> <th>NOX</th> <th>RM</th> <th>AGE</th> <th>DIS</th> <th>RAD</th> <th>TAX</th> <th>PTRATIO</th> <th>B</th> <th>LSTAT</th> <th>MEDV</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>0.00632</td> <td>18.0</td> <td>2.31</td> <td>0</td> <td>0.538</td> <td>6.575</td> <td>65.2</td> <td>4.0900</td> <td>1</td> <td>296.0</td> <td>15.3</td> <td>396.90</td> <td>4.98</td> <td>24.0</td> </tr> <tr> <th>1</th> <td>0.02731</td> <td>0.0</td> <td>7.07</td> <td>0</td> <td>0.469</td> <td>6.421</td> <td>78.9</td> <td>4.9671</td> <td>2</td> <td>242.0</td> <td>17.8</td> <td>396.90</td> <td>9.14</td> <td>21.6</td> </tr> <tr> <th>2</th> <td>0.02729</td> <td>0.0</td> <td>7.07</td> <td>0</td> <td>0.469</td> <td>7.185</td> <td>61.1</td> <td>4.9671</td> <td>2</td> <td>242.0</td> <td>17.8</td> <td>392.83</td> <td>4.03</td> <td>34.7</td> </tr> <tr> <th>3</th> <td>0.03237</td> <td>0.0</td> <td>2.18</td> <td>0</td> <td>0.458</td> <td>6.998</td> <td>45.8</td> <td>6.0622</td> <td>3</td> <td>222.0</td> <td>18.7</td> <td>394.63</td> <td>2.94</td> <td>33.4</td> </tr> <tr> <th>4</th> <td>0.06905</td> <td>0.0</td> <td>2.18</td> <td>0</td> <td>0.458</td> <td>7.147</td> <td>54.2</td> <td>6.0622</td> <td>3</td> <td>222.0</td> <td>18.7</td> <td>396.90</td> <td>5.33</td> <td>36.2</td> </tr> </tbody> </table> </div> <h3 id=training-our-first-model>Training our first model</h3> <p>In week 4, we learned that to train a model (for supervised machine learning), we needed to have a set of X variables (also called independent, predictor etc), and then, we needed a y variable (also called dependent, outcome, predicted etc).</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=c1># Selecting our X set and y</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=n>X</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>drop</span><span class=p>(</span><span class=s1>&#39;MEDV&#39;</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=n>y</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>MEDV</span>
</span></code></pre></div> <p>Now we can train the <code>KNeighborsRegressor</code> model, this model naturally makes predictions by averaging the values of the 5 neighbors to the point that you want to predict</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=c1># lets traing the KNeighborsRegressor</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=n>knn_model</span> <span class=o>=</span> <span class=n>KNeighborsRegressor</span><span class=p>()</span> <span class=c1># instanciate the model class</span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=n>knn_model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span> <span class=c1># train the model on X, y</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=n>score</span> <span class=o>=</span> <span class=n>knn_model</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span> <span class=c1># obtain the model score on X, y</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=n>predicted_y</span> <span class=o>=</span> <span class=n>knn_model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X</span><span class=p>)</span> <span class=c1># make predictions on X</span>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;score:&#39;</span><span class=p>,</span> <span class=n>score</span><span class=p>)</span>
</span></code></pre></div> <div class="language-text highlight"><pre><span></span><code>score: 0.716098217736928
</code></pre></div> <p>Now lets go ahead and try to visualize the performance of the model. The scatter plot is of true labels against predicted labels. Do you think the model is doing well?</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=c1># looking at the performance </span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>predicted_y</span><span class=p>)</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>&#39;Model Performance&#39;</span><span class=p>)</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>&#39;Predicted y&#39;</span><span class=p>)</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>&#39;True y&#39;</span><span class=p>)</span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><img alt=png src=../output_15_0.png></p> <h2 id=some-feature-selection>Some feature selection.</h2> <p>Feature selection is a process where you automatically select those features in your data that contribute most to the prediction variable or output in which you are interested.</p> <p>In week 7 we learned that having irrelevant features in your data can decrease the accuracy of many models. In the code below, we try to find out the best features that best contribute to the outcome variable</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.feature_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>SelectKBest</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.feature_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>f_regression</span> <span class=c1># score function for ANOVA with continuous outcome</span>
</span></code></pre></div> <div class="language-python highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=c1># lets do some feature selection using ANOVA</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=n>data_num</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>drop</span><span class=p>([</span><span class=s1>&#39;CHAS&#39;</span><span class=p>,</span><span class=s1>&#39;RAD&#39;</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span> <span class=c1># dropping categorical</span>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=n>X</span> <span class=o>=</span> <span class=n>data_num</span><span class=o>.</span><span class=n>drop</span><span class=p>(</span><span class=s2>&quot;MEDV&quot;</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span> 
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=n>y</span> <span class=o>=</span> <span class=n>data_num</span><span class=o>.</span><span class=n>MEDV</span>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a><span class=c1># using SelectKBest</span>
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a><span class=n>test_reg</span> <span class=o>=</span> <span class=n>SelectKBest</span><span class=p>(</span><span class=n>score_func</span><span class=o>=</span><span class=n>f_regression</span><span class=p>,</span> <span class=n>k</span><span class=o>=</span><span class=mi>6</span><span class=p>)</span> 
</span><span id=__span-8-9><a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a><span class=n>fit_boston</span> <span class=o>=</span> <span class=n>test_reg</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
</span><span id=__span-8-10><a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a><span class=n>indexes</span> <span class=o>=</span> <span class=n>fit_boston</span><span class=o>.</span><span class=n>get_support</span><span class=p>(</span><span class=n>indices</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-8-11><a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a>
</span><span id=__span-8-12><a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a><span class=nb>print</span><span class=p>(</span><span class=n>fit_boston</span><span class=o>.</span><span class=n>scores_</span><span class=p>)</span>
</span><span id=__span-8-13><a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a><span class=nb>print</span><span class=p>(</span><span class=n>indexes</span><span class=p>)</span>
</span></code></pre></div> <div class="language-text highlight"><pre><span></span><code>[ 89.48611476  75.2576423  153.95488314 112.59148028 471.84673988
  83.47745922  33.57957033 141.76135658 175.10554288  63.05422911
 601.61787111]
[ 2  3  4  7  8 10]
</code></pre></div> <p>From above, we can see from above that the best features for now are those in indexes <code>[ 2 3 4 7 8 10]</code> in the <code>num_data</code> dataset. Lets find them in the <code>data</code> and add on our categorical ones to set up our new X set</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=n>data_num</span><span class=o>.</span><span class=n>sample</span><span class=p>()</span>
</span></code></pre></div> <div> <style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style> <table border=1 class=dataframe> <thead> <tr style="text-align: right;"> <th></th> <th>CRIM</th> <th>ZN</th> <th>INDUS</th> <th>NOX</th> <th>RM</th> <th>AGE</th> <th>DIS</th> <th>TAX</th> <th>PTRATIO</th> <th>B</th> <th>LSTAT</th> <th>MEDV</th> </tr> </thead> <tbody> <tr> <th>211</th> <td>0.37578</td> <td>0.0</td> <td>10.59</td> <td>0.489</td> <td>5.404</td> <td>88.6</td> <td>3.665</td> <td>277.0</td> <td>18.6</td> <td>395.24</td> <td>23.98</td> <td>19.3</td> </tr> </tbody> </table> </div> <div class="language-python highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=c1># redifining the X set </span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=n>new_X</span> <span class=o>=</span> <span class=n>data</span><span class=p>[[</span><span class=s1>&#39;INDUS&#39;</span><span class=p>,</span> <span class=s1>&#39;NOX&#39;</span><span class=p>,</span> <span class=s1>&#39;RM&#39;</span><span class=p>,</span> <span class=s1>&#39;TAX&#39;</span><span class=p>,</span> <span class=s1>&#39;PTRATIO&#39;</span><span class=p>,</span> <span class=s1>&#39;LSTAT&#39;</span><span class=p>,</span> <span class=s1>&#39;CHAS&#39;</span><span class=p>,</span><span class=s1>&#39;RAD&#39;</span><span class=p>]]</span>
</span></code></pre></div> <h3 id=training-our-second-model>Training our second model</h3> <p>Now that we have selected out the features, X that we thing best contribute to the outcome, let's retrain our machine learning model and see if we are gonna get better results</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=n>knn_model</span> <span class=o>=</span> <span class=n>KNeighborsRegressor</span><span class=p>()</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=n>knn_model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>new_X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=n>new_score</span> <span class=o>=</span> <span class=n>knn_model</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>new_X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a><span class=n>new_predicted_y</span> <span class=o>=</span> <span class=n>knn_model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>new_X</span><span class=p>)</span>
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a>
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Feature selected score:&#39;</span><span class=p>,</span> <span class=n>new_score</span><span class=p>)</span>
</span></code></pre></div> <div class="language-text highlight"><pre><span></span><code>Feature selected score: 0.8324963639640872
</code></pre></div> <p>The model seems to score better with a significant increment in accuracy from <code>0.71</code> to <code>0.83</code>. As like last time, let us try to visualize the difference in performance</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>new_predicted_y</span><span class=p>)</span>
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>&#39;Model Performance&#39;</span><span class=p>)</span>
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>&#39;New Predicted y&#39;</span><span class=p>)</span>
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>&#39;True y&#39;</span><span class=p>)</span>
</span><span id=__span-12-5><a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><img alt=png src=../output_25_0.png></p> <p>I do not know about you, but as for me, I notice a meaningful improvement in the predictions made from the model considering this scatter plot</p> <h2 id=transforming-the-data>Transforming the data</h2> <p>In week 7, we learned some advantages of scaling our data like:</p> <ul> <li>preventing dominance by features with larger scales</li> <li>faster convergence in optimization algorithms</li> <li> <p>reduce the impact of outliers</p> </li> <li> <p><strong>Numeric Transformer</strong>: </p> </li> </ul> <div class="language-python highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=c1># importing the StandardScaler</span>
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span>
</span><span id=__span-13-3><a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a>
</span><span id=__span-13-4><a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=c1># instanciating the StandardScaler</span>
</span><span id=__span-13-5><a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a><span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span> 
</span></code></pre></div> <p>This initializes a <code>StandardScaler</code> which standardizes features by removing the mean and scaling to unit variance. It's applied to numeric columns to ensure they are on a similar scale.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=n>standardized_data_num</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span>
</span><span id=__span-14-2><a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a>    <span class=n>data</span><span class=p>[[</span><span class=s1>&#39;INDUS&#39;</span><span class=p>,</span> <span class=s1>&#39;NOX&#39;</span><span class=p>,</span> <span class=s1>&#39;RM&#39;</span><span class=p>,</span> <span class=s1>&#39;TAX&#39;</span><span class=p>,</span> <span class=s1>&#39;PTRATIO&#39;</span><span class=p>,</span> <span class=s1>&#39;LSTAT&#39;</span><span class=p>]]</span>
</span><span id=__span-14-3><a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a>    <span class=p>)</span> <span class=c1># rescaline numeric features</span>
</span><span id=__span-14-4><a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a><span class=n>standardized_data_num_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span>
</span><span id=__span-14-5><a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a>    <span class=n>standardized_data_num</span><span class=p>,</span> 
</span><span id=__span-14-6><a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a>    <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;INDUS&#39;</span><span class=p>,</span> <span class=s1>&#39;NOX&#39;</span><span class=p>,</span> <span class=s1>&#39;RM&#39;</span><span class=p>,</span> <span class=s1>&#39;TAX&#39;</span><span class=p>,</span> <span class=s1>&#39;PTRATIO&#39;</span><span class=p>,</span> <span class=s1>&#39;LSTAT&#39;</span><span class=p>]</span> 
</span><span id=__span-14-7><a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a>    <span class=p>)</span> <span class=c1># converting the standardized to dataframe</span>
</span></code></pre></div> <div class="language-python highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=n>standardized_data_num_df</span><span class=o>.</span><span class=n>head</span><span class=p>()</span>
</span></code></pre></div> <div> <style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style> <table border=1 class=dataframe> <thead> <tr style="text-align: right;"> <th></th> <th>INDUS</th> <th>NOX</th> <th>RM</th> <th>TAX</th> <th>PTRATIO</th> <th>LSTAT</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>-1.287909</td> <td>-0.144217</td> <td>0.413672</td> <td>-0.666608</td> <td>-1.459000</td> <td>-1.075562</td> </tr> <tr> <th>1</th> <td>-0.593381</td> <td>-0.740262</td> <td>0.194274</td> <td>-0.987329</td> <td>-0.303094</td> <td>-0.492439</td> </tr> <tr> <th>2</th> <td>-0.593381</td> <td>-0.740262</td> <td>1.282714</td> <td>-0.987329</td> <td>-0.303094</td> <td>-1.208727</td> </tr> <tr> <th>3</th> <td>-1.306878</td> <td>-0.835284</td> <td>1.016303</td> <td>-1.106115</td> <td>0.113032</td> <td>-1.361517</td> </tr> <tr> <th>4</th> <td>-1.306878</td> <td>-0.835284</td> <td>1.228577</td> <td>-1.106115</td> <td>0.113032</td> <td>-1.026501</td> </tr> </tbody> </table> </div> <ol> <li><strong>Categorical Transformer</strong>: </li> </ol> <div class="language-python highlight"><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=c1># importing the OneHotEncoder</span>
</span><span id=__span-16-2><a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>OneHotEncoder</span>
</span><span id=__span-16-3><a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a>
</span><span id=__span-16-4><a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a><span class=c1># instanciating the OneHotEncoder</span>
</span><span id=__span-16-5><a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a><span class=n>one_hot_encoder</span> <span class=o>=</span> <span class=n>OneHotEncoder</span><span class=p>()</span>
</span></code></pre></div> <p>This initializes a <code>OneHotEncoder</code> which converts categorical variables into a format that can be provided to ML algorithms to do a better job in prediction.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=n>encoded_data_cat</span> <span class=o>=</span> <span class=n>one_hot_encoder</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>data</span><span class=p>[[</span><span class=s1>&#39;CHAS&#39;</span><span class=p>,</span> <span class=s1>&#39;RAD&#39;</span><span class=p>]])</span>
</span><span id=__span-17-2><a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a><span class=n>encoded_data_cat_array</span> <span class=o>=</span> <span class=n>encoded_data_cat</span><span class=o>.</span><span class=n>toarray</span><span class=p>()</span>
</span><span id=__span-17-3><a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=c1># Get feature names</span>
</span><span id=__span-17-4><a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a><span class=n>feature_names</span> <span class=o>=</span> <span class=n>one_hot_encoder</span><span class=o>.</span><span class=n>get_feature_names_out</span><span class=p>([</span><span class=s1>&#39;CHAS&#39;</span><span class=p>,</span> <span class=s1>&#39;RAD&#39;</span><span class=p>])</span>
</span><span id=__span-17-5><a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a>
</span><span id=__span-17-6><a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a><span class=n>encoded_data_cat_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span>
</span><span id=__span-17-7><a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a>    <span class=n>data</span><span class=o>=</span><span class=n>encoded_data_cat_array</span><span class=p>,</span>
</span><span id=__span-17-8><a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a>    <span class=n>columns</span><span class=o>=</span><span class=n>feature_names</span>
</span><span id=__span-17-9><a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a><span class=p>)</span>
</span></code></pre></div> <div class="language-python highlight"><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=n>encoded_data_cat_df</span><span class=o>.</span><span class=n>head</span><span class=p>()</span>
</span></code></pre></div> <div> <style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style> <table border=1 class=dataframe> <thead> <tr style="text-align: right;"> <th></th> <th>CHAS_0</th> <th>CHAS_1</th> <th>RAD_1</th> <th>RAD_2</th> <th>RAD_3</th> <th>RAD_4</th> <th>RAD_5</th> <th>RAD_6</th> <th>RAD_7</th> <th>RAD_8</th> <th>RAD_24</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>1.0</td> <td>0.0</td> <td>1.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> </tr> <tr> <th>1</th> <td>1.0</td> <td>0.0</td> <td>0.0</td> <td>1.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> </tr> <tr> <th>2</th> <td>1.0</td> <td>0.0</td> <td>0.0</td> <td>1.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> </tr> <tr> <th>3</th> <td>1.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>1.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> </tr> <tr> <th>4</th> <td>1.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>1.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> </tr> </tbody> </table> </div> <p>Let us add that to the new X and form a standardized new X set</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-19-1><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=n>transformed_new_X</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>(</span>
</span><span id=__span-19-2><a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a>    <span class=p>[</span><span class=n>standardized_data_num_df</span><span class=p>,</span> <span class=n>encoded_data_cat_df</span><span class=p>],</span> 
</span><span id=__span-19-3><a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a>    <span class=n>axis</span><span class=o>=</span><span class=mi>1</span>
</span><span id=__span-19-4><a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a>    <span class=p>)</span>
</span></code></pre></div> <div class="language-python highlight"><pre><span></span><code><span id=__span-20-1><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=n>transformed_new_X</span><span class=o>.</span><span class=n>head</span><span class=p>()</span>
</span></code></pre></div> <div> <style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style> <table border=1 class=dataframe> <thead> <tr style="text-align: right;"> <th></th> <th>INDUS</th> <th>NOX</th> <th>RM</th> <th>TAX</th> <th>PTRATIO</th> <th>LSTAT</th> <th>CHAS_0</th> <th>CHAS_1</th> <th>RAD_1</th> <th>RAD_2</th> <th>RAD_3</th> <th>RAD_4</th> <th>RAD_5</th> <th>RAD_6</th> <th>RAD_7</th> <th>RAD_8</th> <th>RAD_24</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>-1.287909</td> <td>-0.144217</td> <td>0.413672</td> <td>-0.666608</td> <td>-1.459000</td> <td>-1.075562</td> <td>1.0</td> <td>0.0</td> <td>1.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> </tr> <tr> <th>1</th> <td>-0.593381</td> <td>-0.740262</td> <td>0.194274</td> <td>-0.987329</td> <td>-0.303094</td> <td>-0.492439</td> <td>1.0</td> <td>0.0</td> <td>0.0</td> <td>1.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> </tr> <tr> <th>2</th> <td>-0.593381</td> <td>-0.740262</td> <td>1.282714</td> <td>-0.987329</td> <td>-0.303094</td> <td>-1.208727</td> <td>1.0</td> <td>0.0</td> <td>0.0</td> <td>1.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> </tr> <tr> <th>3</th> <td>-1.306878</td> <td>-0.835284</td> <td>1.016303</td> <td>-1.106115</td> <td>0.113032</td> <td>-1.361517</td> <td>1.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>1.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> </tr> <tr> <th>4</th> <td>-1.306878</td> <td>-0.835284</td> <td>1.228577</td> <td>-1.106115</td> <td>0.113032</td> <td>-1.026501</td> <td>1.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>1.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> </tr> </tbody> </table> </div> <h3 id=training-our-third-model>Training our third model</h3> <p>Now that we have the <em>right</em> features selected and standardized, let us train a new model and see if it is gonna beat the first models</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-21-1><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=n>knn_model</span> <span class=o>=</span> <span class=n>KNeighborsRegressor</span><span class=p>()</span>
</span><span id=__span-21-2><a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a><span class=n>knn_model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>transformed_new_X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
</span><span id=__span-21-3><a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a><span class=n>new_transformed_score</span> <span class=o>=</span> <span class=n>knn_model</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>transformed_new_X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
</span><span id=__span-21-4><a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a><span class=n>new_predicted_y</span> <span class=o>=</span> <span class=n>knn_model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>transformed_new_X</span><span class=p>)</span>
</span><span id=__span-21-5><a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a>
</span><span id=__span-21-6><a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Transformed score:&#39;</span><span class=p>,</span> <span class=n>new_transformed_score</span><span class=p>)</span>
</span></code></pre></div> <div class="language-text highlight"><pre><span></span><code>Transformed score: 0.8734524530397529
</code></pre></div> <p>This new models appears to do better than the earlier ones with an improvement in score from <code>0.83</code> to <code>0.87</code>. Do you think this is now a good model?</p> <h2 id=the-pipeline>The Pipeline</h2> <p>It turns out the above efforts to improve the performance of the model add extra steps to pass before you can have a <em>good</em> model. But what about if we can put together the transformers into on object we do most of that stuff.</p> <p>The sklearn <code>Pipeline</code> allows you to sequentially apply a list of transformers to preprocess the data and, if desired, conclude the sequence with a final predictor for predictive modeling.</p> <p>Intermediate steps of the pipeline must be ‘transforms’, that is, they must implement fit and transform methods. The final estimator only needs to implement fit.</p> <p>Let us build a model that puts together transformation and modelling steps into one <code>pipeline</code> object</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-22-1><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=c1># lets import the Pipeline from sklearn</span>
</span><span id=__span-22-2><a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a>
</span><span id=__span-22-3><a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.pipeline</span><span class=w> </span><span class=kn>import</span> <span class=n>Pipeline</span>
</span><span id=__span-22-4><a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.compose</span><span class=w> </span><span class=kn>import</span> <span class=n>ColumnTransformer</span>
</span></code></pre></div> <div class="language-python highlight"><pre><span></span><code><span id=__span-23-1><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=n>numeric_cols</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;INDUS&#39;</span><span class=p>,</span> <span class=s1>&#39;NOX&#39;</span><span class=p>,</span> <span class=s1>&#39;RM&#39;</span><span class=p>,</span> <span class=s1>&#39;TAX&#39;</span><span class=p>,</span> <span class=s1>&#39;PTRATIO&#39;</span><span class=p>,</span> <span class=s1>&#39;LSTAT&#39;</span><span class=p>]</span>
</span><span id=__span-23-2><a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a><span class=n>categorical_cols</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;CHAS&#39;</span><span class=p>,</span> <span class=s1>&#39;RAD&#39;</span><span class=p>]</span>
</span></code></pre></div> <div class="language-python highlight"><pre><span></span><code><span id=__span-24-1><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=c1># Preprocessing steps</span>
</span><span id=__span-24-2><a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a><span class=n>numeric_transformer</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
</span><span id=__span-24-3><a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a><span class=n>categorical_transformer</span> <span class=o>=</span> <span class=n>OneHotEncoder</span><span class=p>()</span>
</span><span id=__span-24-4><a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a>
</span><span id=__span-24-5><a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a><span class=c1># Combine preprocessing steps</span>
</span><span id=__span-24-6><a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a><span class=n>preprocessor</span> <span class=o>=</span> <span class=n>ColumnTransformer</span><span class=p>(</span>
</span><span id=__span-24-7><a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a>    <span class=n>transformers</span><span class=o>=</span><span class=p>[</span>
</span><span id=__span-24-8><a id=__codelineno-24-8 name=__codelineno-24-8 href=#__codelineno-24-8></a>        <span class=p>(</span><span class=s1>&#39;numerical&#39;</span><span class=p>,</span> <span class=n>numeric_transformer</span><span class=p>,</span> <span class=n>numeric_cols</span><span class=p>),</span>
</span><span id=__span-24-9><a id=__codelineno-24-9 name=__codelineno-24-9 href=#__codelineno-24-9></a>        <span class=p>(</span><span class=s1>&#39;categorical&#39;</span><span class=p>,</span> <span class=n>categorical_transformer</span><span class=p>,</span> <span class=n>categorical_cols</span><span class=p>)</span>
</span><span id=__span-24-10><a id=__codelineno-24-10 name=__codelineno-24-10 href=#__codelineno-24-10></a>    <span class=p>])</span>
</span><span id=__span-24-11><a id=__codelineno-24-11 name=__codelineno-24-11 href=#__codelineno-24-11></a>
</span><span id=__span-24-12><a id=__codelineno-24-12 name=__codelineno-24-12 href=#__codelineno-24-12></a><span class=c1># Pipeline</span>
</span><span id=__span-24-13><a id=__codelineno-24-13 name=__codelineno-24-13 href=#__codelineno-24-13></a><span class=n>pipe</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
</span><span id=__span-24-14><a id=__codelineno-24-14 name=__codelineno-24-14 href=#__codelineno-24-14></a>    <span class=p>(</span><span class=s1>&#39;preprocessor&#39;</span><span class=p>,</span> <span class=n>preprocessor</span><span class=p>),</span>
</span><span id=__span-24-15><a id=__codelineno-24-15 name=__codelineno-24-15 href=#__codelineno-24-15></a>    <span class=p>(</span><span class=s1>&#39;model&#39;</span><span class=p>,</span> <span class=n>KNeighborsRegressor</span><span class=p>())</span>
</span><span id=__span-24-16><a id=__codelineno-24-16 name=__codelineno-24-16 href=#__codelineno-24-16></a><span class=p>])</span>
</span><span id=__span-24-17><a id=__codelineno-24-17 name=__codelineno-24-17 href=#__codelineno-24-17></a>
</span><span id=__span-24-18><a id=__codelineno-24-18 name=__codelineno-24-18 href=#__codelineno-24-18></a><span class=c1># display pipe</span>
</span><span id=__span-24-19><a id=__codelineno-24-19 name=__codelineno-24-19 href=#__codelineno-24-19></a><span class=n>pipe</span>
</span></code></pre></div> <style>#sk-container-id-2 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-2 {
  color: var(--sklearn-color-text);
}

#sk-container-id-2 pre {
  padding: 0;
}

#sk-container-id-2 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-2 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-2 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-2 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-2 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-2 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-2 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-2 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-2 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-2 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-2 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-2 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-2 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-2 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-2 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-2 div.sk-label label.sk-toggleable__label,
#sk-container-id-2 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-2 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-2 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-2 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-2 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-2 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-2 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-2 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-2 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-2 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style> <div id=sk-container-id-2 class=sk-top-container><div class=sk-text-repr-fallback><pre>Pipeline(steps=[(&#x27;preprocessor&#x27;,
                 ColumnTransformer(transformers=[(&#x27;numerical&#x27;, StandardScaler(),
                                                  [&#x27;INDUS&#x27;, &#x27;NOX&#x27;, &#x27;RM&#x27;, &#x27;TAX&#x27;,
                                                   &#x27;PTRATIO&#x27;, &#x27;LSTAT&#x27;]),
                                                 (&#x27;categorical&#x27;,
                                                  OneHotEncoder(),
                                                  [&#x27;CHAS&#x27;, &#x27;RAD&#x27;])])),
                (&#x27;model&#x27;, KNeighborsRegressor())])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=sk-container hidden><div class="sk-item sk-dashed-wrapped"><div class=sk-label-container><div class="sk-label  sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=sk-estimator-id-8 type=checkbox><label for=sk-estimator-id-8 class="sk-toggleable__label  sk-toggleable__label-arrow ">&nbsp;&nbsp;Pipeline<a class="sk-estimator-doc-link " rel=noreferrer target=_blank href=https://scikit-learn.org/1.4/modules/generated/sklearn.pipeline.Pipeline.html>?<span>Documentation for Pipeline</span></a><span class="sk-estimator-doc-link ">i<span>Not fitted</span></span></label><div class="sk-toggleable__content "><pre>Pipeline(steps=[(&#x27;preprocessor&#x27;,
                 ColumnTransformer(transformers=[(&#x27;numerical&#x27;, StandardScaler(),
                                                  [&#x27;INDUS&#x27;, &#x27;NOX&#x27;, &#x27;RM&#x27;, &#x27;TAX&#x27;,
                                                   &#x27;PTRATIO&#x27;, &#x27;LSTAT&#x27;]),
                                                 (&#x27;categorical&#x27;,
                                                  OneHotEncoder(),
                                                  [&#x27;CHAS&#x27;, &#x27;RAD&#x27;])])),
                (&#x27;model&#x27;, KNeighborsRegressor())])</pre></div> </div></div><div class=sk-serial><div class="sk-item sk-dashed-wrapped"><div class=sk-label-container><div class="sk-label  sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=sk-estimator-id-9 type=checkbox><label for=sk-estimator-id-9 class="sk-toggleable__label  sk-toggleable__label-arrow ">&nbsp;preprocessor: ColumnTransformer<a class="sk-estimator-doc-link " rel=noreferrer target=_blank href=https://scikit-learn.org/1.4/modules/generated/sklearn.compose.ColumnTransformer.html>?<span>Documentation for preprocessor: ColumnTransformer</span></a></label><div class="sk-toggleable__content "><pre>ColumnTransformer(transformers=[(&#x27;numerical&#x27;, StandardScaler(),
                                 [&#x27;INDUS&#x27;, &#x27;NOX&#x27;, &#x27;RM&#x27;, &#x27;TAX&#x27;, &#x27;PTRATIO&#x27;,
                                  &#x27;LSTAT&#x27;]),
                                (&#x27;categorical&#x27;, OneHotEncoder(),
                                 [&#x27;CHAS&#x27;, &#x27;RAD&#x27;])])</pre></div> </div></div><div class=sk-parallel><div class=sk-parallel-item><div class=sk-item><div class=sk-label-container><div class="sk-label  sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=sk-estimator-id-10 type=checkbox><label for=sk-estimator-id-10 class="sk-toggleable__label  sk-toggleable__label-arrow ">numerical</label><div class="sk-toggleable__content "><pre>[&#x27;INDUS&#x27;, &#x27;NOX&#x27;, &#x27;RM&#x27;, &#x27;TAX&#x27;, &#x27;PTRATIO&#x27;, &#x27;LSTAT&#x27;]</pre></div> </div></div><div class=sk-serial><div class=sk-item><div class="sk-estimator  sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=sk-estimator-id-11 type=checkbox><label for=sk-estimator-id-11 class="sk-toggleable__label  sk-toggleable__label-arrow ">&nbsp;StandardScaler<a class="sk-estimator-doc-link " rel=noreferrer target=_blank href=https://scikit-learn.org/1.4/modules/generated/sklearn.preprocessing.StandardScaler.html>?<span>Documentation for StandardScaler</span></a></label><div class="sk-toggleable__content "><pre>StandardScaler()</pre></div> </div></div></div></div></div><div class=sk-parallel-item><div class=sk-item><div class=sk-label-container><div class="sk-label  sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=sk-estimator-id-12 type=checkbox><label for=sk-estimator-id-12 class="sk-toggleable__label  sk-toggleable__label-arrow ">categorical</label><div class="sk-toggleable__content "><pre>[&#x27;CHAS&#x27;, &#x27;RAD&#x27;]</pre></div> </div></div><div class=sk-serial><div class=sk-item><div class="sk-estimator  sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=sk-estimator-id-13 type=checkbox><label for=sk-estimator-id-13 class="sk-toggleable__label  sk-toggleable__label-arrow ">&nbsp;OneHotEncoder<a class="sk-estimator-doc-link " rel=noreferrer target=_blank href=https://scikit-learn.org/1.4/modules/generated/sklearn.preprocessing.OneHotEncoder.html>?<span>Documentation for OneHotEncoder</span></a></label><div class="sk-toggleable__content "><pre>OneHotEncoder()</pre></div> </div></div></div></div></div></div></div><div class=sk-item><div class="sk-estimator  sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=sk-estimator-id-14 type=checkbox><label for=sk-estimator-id-14 class="sk-toggleable__label  sk-toggleable__label-arrow ">&nbsp;KNeighborsRegressor<a class="sk-estimator-doc-link " rel=noreferrer target=_blank href=https://scikit-learn.org/1.4/modules/generated/sklearn.neighbors.KNeighborsRegressor.html>?<span>Documentation for KNeighborsRegressor</span></a></label><div class="sk-toggleable__content "><pre>KNeighborsRegressor()</pre></div> </div></div></div></div></div></div> <p>The code above sets up a data preprocessing and modeling pipeline using the <code>scikit-learn</code> library. Let's break down each part:</p> <h3 id=combine-preprocessing-steps>Combine Preprocessing Steps</h3> <ol> <li><strong>ColumnTransformer</strong>: <div class="language-python highlight"><pre><span></span><code><span id=__span-25-1><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=n>preprocessor</span> <span class=o>=</span> <span class=n>ColumnTransformer</span><span class=p>(</span>
</span><span id=__span-25-2><a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a>    <span class=n>transformers</span><span class=o>=</span><span class=p>[</span>
</span><span id=__span-25-3><a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a>        <span class=p>(</span><span class=s1>&#39;numerical&#39;</span><span class=p>,</span> <span class=n>numeric_transformer</span><span class=p>,</span> <span class=n>numeric_cols</span><span class=p>),</span>
</span><span id=__span-25-4><a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a>        <span class=p>(</span><span class=s1>&#39;categorical&#39;</span><span class=p>,</span> <span class=n>categorical_transformer</span><span class=p>,</span> <span class=n>categorical_cols</span><span class=p>)</span>
</span><span id=__span-25-5><a id=__codelineno-25-5 name=__codelineno-25-5 href=#__codelineno-25-5></a>    <span class=p>])</span>
</span></code></pre></div></li> <li>The <code>ColumnTransformer</code> is used to apply different preprocessing steps to different columns of the data. It combines the <code>numeric_transformer</code> for numeric columns and the <code>categorical_transformer</code> for categorical columns.</li> <li><code>numeric_cols</code> and <code>categorical_cols</code> are lists containing the names of numeric and categorical columns respectively.</li> </ol> <h3 id=pipeline_1>Pipeline</h3> <ol> <li><strong>Pipeline Setup</strong>: <div class="language-python highlight"><pre><span></span><code><span id=__span-26-1><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=n>pipe</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
</span><span id=__span-26-2><a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a>    <span class=p>(</span><span class=s1>&#39;preprocessor&#39;</span><span class=p>,</span> <span class=n>preprocessor</span><span class=p>),</span>
</span><span id=__span-26-3><a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a>    <span class=p>(</span><span class=s1>&#39;model&#39;</span><span class=p>,</span> <span class=n>KNeighborsRegressor</span><span class=p>())</span>
</span><span id=__span-26-4><a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a><span class=p>])</span>
</span></code></pre></div></li> <li>A <code>Pipeline</code> is created which sequentially applies a list of transforms and a final estimator. </li> <li>The <code>preprocessor</code> step applies the <code>ColumnTransformer</code> defined earlier.</li> <li>The <code>model</code> step applies a <code>KNeighborsRegressor</code>, which is a regression model that predicts the target variable based on the k-nearest neighbors in the feature space.</li> </ol> <p>Now we can instead fit the Pipeline and use it for making predictions</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-27-1><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=c1># Fit the pipeline</span>
</span><span id=__span-27-2><a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a><span class=n>pipe</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>new_X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
</span><span id=__span-27-3><a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a>
</span><span id=__span-27-4><a id=__codelineno-27-4 name=__codelineno-27-4 href=#__codelineno-27-4></a><span class=c1># Score the pipeline</span>
</span><span id=__span-27-5><a id=__codelineno-27-5 name=__codelineno-27-5 href=#__codelineno-27-5></a><span class=n>pipe_score</span> <span class=o>=</span> <span class=n>pipe</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>new_X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
</span><span id=__span-27-6><a id=__codelineno-27-6 name=__codelineno-27-6 href=#__codelineno-27-6></a>
</span><span id=__span-27-7><a id=__codelineno-27-7 name=__codelineno-27-7 href=#__codelineno-27-7></a><span class=c1># Predict using the pipeline</span>
</span><span id=__span-27-8><a id=__codelineno-27-8 name=__codelineno-27-8 href=#__codelineno-27-8></a><span class=n>pipe_predicted_y</span> <span class=o>=</span> <span class=n>pipe</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>new_X</span><span class=p>)</span>
</span><span id=__span-27-9><a id=__codelineno-27-9 name=__codelineno-27-9 href=#__codelineno-27-9></a>
</span><span id=__span-27-10><a id=__codelineno-27-10 name=__codelineno-27-10 href=#__codelineno-27-10></a><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Pipe Score:&#39;</span><span class=p>,</span> <span class=n>pipe_score</span><span class=p>)</span>
</span></code></pre></div> <div class="language-text highlight"><pre><span></span><code>Pipe Score: 0.8734524530397529
</code></pre></div> <div class="language-python highlight"><pre><span></span><code><span id=__span-28-1><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>pipe_predicted_y</span><span class=p>)</span>
</span><span id=__span-28-2><a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>&#39;Pipe Performance&#39;</span><span class=p>)</span>
</span><span id=__span-28-3><a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>&#39;Pipe Predicted y&#39;</span><span class=p>)</span>
</span><span id=__span-28-4><a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>&#39;True y&#39;</span><span class=p>)</span>
</span><span id=__span-28-5><a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><img alt=png src=../output_51_0.png></p> <p>We can observe that the model still gets the same good score, but now all the transformation steps, both on numeric and categorical variables are in a single pipeline object together with the model.</p> <h2>What's on your mind? Put it in the comments!</h2> <script src=https://utteranc.es/client.js repo=dataideaorg/dataidea-science issue-term=pathname theme=github-light crossorigin=anonymous async>
</script> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="July 27, 2025 08:27:50">July 27, 2025</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="July 27, 2025 08:27:50">July 27, 2025</span> </span> </aside> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <!-- add styles to footer --> <footer> <p>© 2025. All rights reserved. Built with ❤️ by <a href=https://github.com/jumashafara target=_blank>Juma Shafara</a>.</p> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["header.autohide", "navigation.footer", "navigation.top", "navigation.tabs", "navigation.expand", "navigation.indexes", "content.code.copy", "announce.dismiss", "content.tabs.link", "content.action.edit", "content.action.view"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../assets/javascripts/bundle.c8b220af.min.js></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> </body> </html>